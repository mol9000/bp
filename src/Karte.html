<!DOCTYPE HTML>
<meta charset="UTF-8">
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Über uns - Blickpunkte</title>

    <!-- Bootstrap CSS CDN -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">
    <!-- Our Custom CSS -->
    <link rel="stylesheet" href="css/styles.css">
    <!-- Scrollbar Custom CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/malihu-custom-scrollbar-plugin/3.1.5/jquery.mCustomScrollbar.min.css">

    <!-- Font Awesome JS -->
    <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/solid.js" integrity="sha384-tzzSw1/Vo+0N5UhStP3bvwWPq+uvzCMfrN1fEFe+xBmv1C/AtVX5K0uZtmcHitFZ" crossorigin="anonymous"></script>
    <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/fontawesome.js" integrity="sha384-6OIrr52G08NpOFSZdxxz1xdNSndlD4vdcf/q2myIUVO0VsqaGHJsB0RaBE01VTOY" crossorigin="anonymous"></script>
    <style type="text/css">
        html,
        body,
        #basicMap {
            width: clac(100vw - 250px);
            height: 100vh;
            margin-left: 125px;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/openlayers/2.11/lib/OpenLayers.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.min.js"></script>
    <script>
        function init() {
            map = new OpenLayers.Map("basicMap");
            var lat = 52.3839;
            var lon = 9.7377;
            var zoom = 13;
            var mapnik = new OpenLayers.Layer.OSM();
            var fromProjection = new OpenLayers.Projection("EPSG:4326");   // Transform from WGS 1984
            var toProjection = new OpenLayers.Projection("EPSG:900913"); // to Spherical Mercator Projection
            var position = new OpenLayers.LonLat(lon, lat).transform(fromProjection, toProjection);

            map.addLayer(mapnik);
            map.setCenter(position, zoom);


            var vectorLayer = new OpenLayers.Layer.Vector("Overlay");


            axios.get('http://localhost:5984/gmci/_all_docs?include_docs=true')
            .then(function(response) {
                var numOfInterviews = response.data.rows; // Enthält alle Interviewobjekte. Einfach mit schleife durchlaufen

                // Zugriff auf Attribute, hier die Koordinaten als Beispiel
                // response.data.rows[ INDEX ].geometryX
                // response.data.rows[ INDEX ].geometryY

                console.log(response.data.total_rows + " Interviews wurden geladen");

            })
            .catch(function(error) {
                console.log(error);
            });





            // Define markers as "features" of the vector layer:
            var leona = new OpenLayers.Feature.Vector(
                new OpenLayers.Geometry.Point( 9.73830 , 52.37436 ).transform(fromProjection, toProjection),
                {description: '<h1>Leona</h1>' +
                        '<img src="https://proxy.duckduckgo.com/iu/?u=http%3A%2F%2Fwww.hannover.de%2Fcontent%2Fdownload%2F487574%2F10832835%2Ffile%2FKr%C3%B6pcke-Center%2Bund%2BKr%C3%B6pcke-Uhr_c_HMTG.jpg&f=1" height="150" width="225"><br>' +
                        '"Es gibt viele Dinge, die einen glücklich<br>' +
                        ' machen finde ich. Auch oft Kleinigkeiten.<br>' +
                        'Deswegen wollte ich auch mit euch irgendwo<br>' +
                        'draußen sein. Weil ich das immer schön finde.<br>' +
                        ' Man sieht Schwäne oder Enten die sich um irgendwas streiten.<br>' +
                        ' Das sind irgendwie diese Kleinigkeiten die ich schön finde."<br>' + '<a href="Interview.html?id=5cf3e4bc4013ff8e84aa14adc7000be1"><u>Weiterlesen</u></a>'},
                {externalGraphic: 'http://icons.iconarchive.com/icons/paomedia/small-n-flat/1024/map-marker-icon.png', graphicHeight: 51.2, graphicWidth: 51.2}
            );
            vectorLayer.addFeatures(leona);

            var xianghu = new OpenLayers.Feature.Vector(
                new OpenLayers.Geometry.Point( 9.73689 , 52.36774 ).transform(fromProjection, toProjection),
                {description: '<h1>Xianghu</h1>' +
                        '<img src="https://proxy.duckduckgo.com/iu/?u=http%3A%2F%2Fwww.heise.de%2Fimagine%2FH2cR2A004rPm4tylHaO8OmwG9RM%2Fgallery%2FRathaus-Hannover.jpg&f=1" height="166.65" width="250"><br>' +
                        'Wenn ich später auf mein Leben zurückblicke, will ich sagen:<br>' +
                        '„Ja, du hast bis jetzt alles richtig gemacht und du bereust nichts,<br>' +
                        'was du bis jetzt gemacht hast“.<br>' + '<a href="Interview.html?id=5cf3e4bc4013ff8e84aa14adc70014e4" class="read-more"><u>Weiterlesen</u></a>'},
                {externalGraphic: 'http://icons.iconarchive.com/icons/paomedia/small-n-flat/1024/map-marker-icon.png', graphicHeight: 51.2, graphicWidth: 51.2}
            );
            vectorLayer.addFeatures(xianghu);

            map.addLayer(vectorLayer);


            //Add a selector control to the vectorLayer with popup functions
            var controls = {
                selector: new OpenLayers.Control.SelectFeature(vectorLayer, {onSelect: createPopup, onUnselect: destroyPopup }),
            };

            function createPopup(feature) {
                feature.popup = new OpenLayers.Popup.FramedCloud("pop",
                    feature.geometry.getBounds().getCenterLonLat(),
                    null,
                    '<div class="markerContent">'+feature.attributes.description+'</div>',
                    null,
                    true,
                    function() { controls['selector'].unselectAll(); }
                );
                //feature.popup.closeOnMove = true;
                map.addPopup(feature.popup);
            }

            function destroyPopup(feature) {
                feature.popup.destroy();
                feature.popup = null;
            }

            map.addControl(controls['selector']);
            controls['selector'].activate();

        }
    </script>
</head>

<body onload="init();">
    <div id="basicMap"></div>
    <div class="wrapper">
        <!-- Sidebar  -->
        <nav id="sidebar">
            <ul class="list-unstyled components">
                <li >
                    <a href="./index.html">Startseite</a>
                </li>
                <li>
                    <a id="interviews" href="./Interviews.html">Interviews</a>
                </li>
                <li class="active">
                    <a id="map" href="./Karte.html">Karte</a>
                </li>
                <li>
                    <a id="apply" href="./Bewerbung.html">Werde Teil</a>
                </li>
                <li>
                    <a id="aboutus" href="./About.html">Über uns</a>
                </li>
            </ul>


            <div class="btn-group dropup fixed-bottom">
                <button type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" id="share-project">
                    Seite teilen
                </button>
                <div class="dropdown-menu">
                    <a class="dropdown-item" href=https://www.facebook.com/ target="_blank"><i class="fab fa-facebook-square"></i> Facebook</a>
                    <a class="dropdown-item" href="https://www.instagram.com/" target="_blank">Instagram</a>
                    <a class="dropdown-item" href="https://twitter.com/" target="_blank">Twitter</a>
                </div>
            </div>
        </nav>
    </div>
</body>

</html>
